<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html;charset=gb2312">
    <meta name="keywords" content=""/>
    <meta name="description" content=""/>
    <meta name="format-detection" content="telephone=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="icon" href="#">
    <script>
        !function(e,t,i,r){function n(){var e=document.querySelector("head"),t=document.createElement("div");t.style.width="1rem",t.style.display="none",e.appendChild(t);var i=parseFloat(window.getComputedStyle(t,null).width);return e.removeChild(t),i}function a(){var r=d.getBoundingClientRect().width;r/c>768&&(r=768*c);var n=r/e*t;if(!i){var a=p/16;n/=a}d.style.fontSize=n+"px",v.rem=n}var m,o=window,l=o.document,d=l.documentElement,s=l.querySelector('meta[name="viewport"]'),c=0,u=0,p=n(),v={};if(s){var h=s.getAttribute("content").match(/initial\-scale=([\d\.]+)/);h&&(console.warn("将根据已有的meta标签来设置缩放比例"),u=parseFloat(h[1]),c=parseInt(1/u))}if(!c&&!u){var f=o.devicePixelRatio;r?(c=f>=3&&(!c||c>=3)?3:f>=2&&(!c||c>=2)?2:1,u=1/c):(c=1,u=1/c)}if(d.setAttribute("data-dpr",c),!s)if(s=l.createElement("meta"),s.setAttribute("name","viewport"),s.setAttribute("content","width=device-width, initial-scale="+u+", maximum-scale="+u+", minimum-scale="+u+", user-scalable=no"),d.firstElementChild)d.firstElementChild.appendChild(s);else{var w=l.createElement("div");w.appendChild(s),l.write(w.innerHTML)}o.addEventListener("resize",function(){clearTimeout(m),m=setTimeout(a,300)},!1),o.addEventListener("pageshow",function(e){e.persisted&&(clearTimeout(m),m=setTimeout(a,300))},!1),a(),v.dpr=c,v.refreshRem=a,v.rem2px=function(e){var t=parseFloat(e)*this.rem;return"string"==typeof e&&e.match(/rem$/)&&(t+="px"),t},v.px2rem=function(e){var t=parseFloat(e)/this.rem;return"string"==typeof e&&e.match(/px$/)&&(t+="rem"),t},window.remmoka=v}
        (750,100,!0,!0);
        /*
        * designWidth, oneRem2Px, resetScaleFontSizeToDefault, useScaleFix1pxTooBold
        * @param designWidth 设计稿宽度 一般来说iPhone6是750 如果缩小就变成了375px
        * @param oneRem2Px 1rem对应多少px
        * @param resetScaleFontSizeToDefault 是否重置Android因为系统放大或者缩小字体带来的影响
        * @param useScaleFix1pxTooBold 是否通过meta标签的scale处理1px过于粗的问题
        * */
    </script>
    <!--<link rel="stylesheet" href="./css/lib/swiper-3.4.2.min.css">-->
    <link rel="stylesheet" type="text/css" href="./css/style.css">
    <script src="./js/lib/vue.min.js"></script>
    <script src="./js/lib/vue.min.js"></script>
    <title>个人中心</title>
</head>
<body class="center">
<div id="page">
    <section class="center-section">
        <div class="center-information">
          <div class="user-pic">
              <img :src="userInfo.userHeadImg"/><!--aaaaaaaaaaaaaaaaaaaaaaaaaa-->
          </div>
          <div class="details">
              <p class="user-name">{{userInfo.userName}}&nbsp;&nbsp; {{userInfo.userSex}}&nbsp;&nbsp;| &nbsp;&nbsp;{{userInfo.userProvince}}</p><!--userName后台获取-->
              <!--<p>-->
                  <!--<a class="follow">{{userInfo.userSex}}<span class="follow-num"></span></a>-->
                  <!--<a class="following" >{{userInfo.userProvince}}<span class="following-num"></span></a>&lt;!&ndash;后台获取&ndash;&gt;-->

              <!--</p>-->
              <p class="follow-following">
                  <!--跳转到关注粉丝页面------------------------->
                  <a class="follow" href="follows_show.html">关注：<span class="follow-num">
                      {{userInfo.userAttentionNum}}</span>
                  </a>
                  <a class="following" href="follows_show.html">粉丝：
                      <span class="following-num">{{userInfo.userFansNum}}</span>
                  </a><!--后台获取-->
              </p>
              <p class="balance">余额 : <span> ￥{{userInfo.userAccount}}</span>
                   元</p>

          </div>
        </div>
        <div class="center-wine-class">
            <div class="title">
                <span class="left"></span>
                <span class="text">您所购买的酒品中</span>
                <span class="right"></span>
            </div>
            <ul class="classify">
                <li>
                  <img src="./img/personal_center/origin.png"/>
                  <p><span class="place-ratio"></span><br>{{random[0]}}%<br><span class="place"></span></p>
                </li>
                <li>
                  <img src="./img/personal_center/brand.png"/>
                  <p><span class="brand-ratio"></span><br>{{random[1]}}%<br><span class="brand"></span></p>
                </li>
                <li>
                  <img src="./img/personal_center/year.png"/>
                  <p><span class="year-ratio"></span><br>{{random[2]}}%<br><span class="year"></span></p>
    </li>
    </ul>
    <ul class="indent">
        <li class="shopping-information">
            <ul>
                <li><a :href="'./allOrder.html?userId='+userInfo.userId">
                    <span><img src="./img/personal_center/car.png"/></span>
                    <p>全部订单</p>
                </a></li>
                <li><a :href="'./address.html?userId='+userInfo.userId">
                    <span><img src="./img/personal_center/evaluate.png"/></span>
                    <p>收货信息管理</p>
                </a></li>
                <li @click="isActive = !isActive;"><a>
                    <span><img src="./img/personal_center/card.png"/></span>
                    <p>充值</p>
                </a></li>
            </ul>
        </li>
        <li class="setting">设置</li>
        <li class="about-us">关于我们</li>
    </ul>
    </div>
    </section>
    <div class="center-charge" v-show="isActive">
        <div class="close" @click="isActive = !isActive">
            <img src="img/goods/error.png" style="width:0.4rem;height:0.4rem"  >
        </div>
        <div class="tip">充值</div>
        <div class="recharge">
            <span class="point">充值金额:</span>
            <div>
                <input type="text" v-model="chargeMsg" class="money" placeholder="请输入充值金额">
                <span>元</span>
            </div>
        </div>
        <div class="confirm" @click="confirm">确认充值</div>
    </div>
    <footer>
        <ul class="footer-list">
            <li>
                <a :href="'./index.html?userId='+this.userId"><img src="img/footer/home-y.png" style="width:0.58rem;height:0.52rem"></a>
                <span>首页</span>
            </li>
            <li>
                <a :href="'./shopping_cart.html?userId='+this.userId"><img src="img/footer/shoppingcart.png" style="width:0.58rem;height:0.52rem"></a>
                <span>购物车</span>
            </li>
            <li>
                <a :href="'./personCenter.html?userId='+this.userId"><img src="img/footer/my.png" style="width:0.58rem;height:0.52rem"></a>
                <span>我的</span>
            </li>
        </ul>
    </footer>

</div>
<script src="./js/lib/vue.min.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
        var instance = axios.create({
            header:{
                contentType: 'application/x-www-form-urlencoded'
            }
        })

        new Vue({
            el:"#page",
            data:{
                isActive:false,
                chargeMsg:'',
                random:[],
                userInfo:[],
                userId:''
            },
            methods:{
                confirm:function(){
                    console.log(this.chargeMsg);
                    console.log(this.userInfo.userId);
                    var that=this;
                    instance({
                        method:"POST",
                        url:"http://dreamjxw.imwork.net:80/jxw/design/user/updateAccount.htm",
                        data:{
                            "userId":that.userInfo.userId,
                            "userAccount":that.chargeMsg
                        },
                        contentType: 'Access-Control-Allow-Origin',
                    }).then(function(res){
                                console.log(res.data);
//                              that.userInfo = res.data.data;
                                that.userInfo.userAccount += parseInt(that.chargeMsg);
                                alert("充值成功");
                            },
                            function(error){
                                console.log(error)
                            })
                }
            },
            mounted(){
                function queryString(key){
                    var src = location.search || location.hash,
                            reg = new RegExp('[?&]' + key + '=([^?&=]*)(?=&|$)'),
                            match = reg.exec(src);
                    return match == null ? null : decodeURIComponent(match[1]);
                }
                var  userId= queryString('userId');
                this.userId = userId;
                console.log(this.userId);
//                this.random = Math.round(Math.random()*50+50);
                for(var i = 0; i < 3; i++){
                    this.random.push(Math.round(Math.random()*50+50));
                }
                var that = this;
                instance({
                    method:"POST",
                    url:"http://dreamjxw.imwork.net:80/jxw/design/user/userInfo.htm",
//                    data:'oXJnE1Rr36wJ2m_czWkvM8JP3eZU',
                    data:userId,
                    contentType: 'Access-Control-Allow-Origin',
                }).then(function(res){
                            console.log(res.data);
                            that.userInfo = res.data.data;
                        },
                        function(error){
                            console.log(error)
                        })
            }


        })


    </script>
</body>
</html>